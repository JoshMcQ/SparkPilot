{
  "Version":"2012-10-17",
  "Statement":[
    {
      "Sid":"EmrOnEksCreateVirtualCluster",
      "Effect":"Allow",
      "Action":[
        "emr-containers:CreateVirtualCluster",
        "emr-containers:TagResource"
      ],
      "Resource":"*",
      "Condition":{"StringEquals":{"aws:RequestTag/sparkpilot:managed":"true"}}
    },
    {
      "Sid":"EmrOnEksVirtualClusterManage",
      "Effect":"Allow",
      "Action":[
        "emr-containers:DeleteVirtualCluster",
        "emr-containers:DescribeVirtualCluster",
        "emr-containers:ListVirtualClusters"
      ],
      "Resource":"arn:aws:emr-containers:*:787587782916:/virtualclusters/*",
      "Condition":{"StringEquals":{"aws:ResourceTag/sparkpilot:managed":"true"}}
    },
    {
      "Sid":"EmrOnEksJobRunLifecycle",
      "Effect":"Allow",
      "Action":[
        "emr-containers:StartJobRun",
        "emr-containers:CancelJobRun",
        "emr-containers:DescribeJobRun",
        "emr-containers:ListJobRuns"
      ],
      "Resource":"*"
    },
    {
      "Sid":"LogAccess",
      "Effect":"Allow",
      "Action":[
        "logs:CreateLogGroup",
        "logs:PutRetentionPolicy",
        "logs:DescribeLogGroups",
        "logs:DescribeLogStreams",
        "logs:FilterLogEvents"
      ],
      "Resource":"arn:aws:logs:*:787587782916:log-group:/sparkpilot/*"
    },
    {
      "Sid":"PassExecutionRole",
      "Effect":"Allow",
      "Action":["iam:PassRole"],
      "Resource":"arn:aws:iam::787587782916:role/SparkPilotEmrExecution*",
      "Condition":{"StringEquals":{"iam:PassedToService":"emr-containers.amazonaws.com"}}
    },
    {
      "Sid":"EksAccessManagementForEmrOnEks",
      "Effect":"Allow",
      "Action":[
        "eks:DescribeCluster",
        "eks:CreateAccessEntry",
        "eks:DeleteAccessEntry",
        "eks:DescribeAccessEntry",
        "eks:ListAccessEntries",
        "eks:AssociateAccessPolicy",
        "eks:DisassociateAccessPolicy",
        "eks:ListAssociatedAccessPolicies",
        "eks:TagResource",
        "eks:UntagResource",
        "eks:ListTagsForResource"
      ],
      "Resource":"*"
    }
  ]
}
